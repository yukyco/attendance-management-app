<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css">
  <style>
    /* ここにCSSを記述するか、外部CSSファイルを読み込む */
  </style>
</head>
<body>
  <h1>シフト入力フォーム</h1>
  <form id="shift-form">
    <label for="date">申請日:</label>
    <input type="date" id="date" name="date" required>
    <br>
    <label for="name">申請者名:</label>
    <input type="text" id="name" name="name" required>
    <br>
    <button type="submit">シフトを申請</button>
  </form>
  
  <script>
    document.getElementById('shift-form').addEventListener('submit', function(event) {
      event.preventDefault();

      const date = document.getElementById('date').value;
      const name = document.getElementById('name').value;
      
      const data = {
        date: date,
        name: name
      };

      // google.script.runを使ってGASのdoPost関数を呼び出す
      google.script.run
        .withSuccessHandler(function(response) {
          // 成功時の処理
          alert(response); // GASから返された文字列を表示
        })
        .withFailureHandler(function(error) {
          // 失敗時の処理
          console.error('Error:', error);
          alert('申請中にエラーが発生しました。');
        })
        .saveShiftData(data); // GASのsaveShiftData関数を呼び出す
    });
  </script>
</body>
</html>
